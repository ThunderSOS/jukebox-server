<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition 
    xmlns = "http://www.w3.org/1999/xhtml"
    xmlns:f = "http://java.sun.com/jsf/core"
    xmlns:h = "http://java.sun.com/jsf/html"
    xmlns:ui = "http://xmlns.jcp.org/jsf/facelets"
    xmlns:c = "jakarta.tags.core">

    <h:form id="searchForm">
        <table>
            <tr>
                <ui:repeat value="#{utilBean.getAlphabet()}" var="letter">
                    <td align="center">
                        <h:commandLink value="#{letter}" action="#{artistListBean.loadArtistsStartingWith()}" class="navigation-link-bold">
                            <f:param name="letter" value="#{letter}" />
                            <f:ajax execute="@this" render="content" />
                        </h:commandLink>
                        &nbsp;
                    </td>                    
                </ui:repeat>
                <td align="center">
                    <h:commandLink value="Un" action="#{trackListBean.loadLooseTracks()}" class="navigation-link-bold">
                        <f:ajax execute="@this" render="content" />
                    </h:commandLink>
                    &nbsp;
                </td>
            </tr>
        </table>
    </h:form>

    <h:panelGroup id="content">
        <h:form id="artistForm">
            <c:if test="#{artistListBean.letterSet 
                          &amp;&amp; artistListBean.shouldRenderArtists()}">
                <table>
                    <tr><td height="6">&nbsp;</td></tr>
                </table>

                <table class="navigation-link-small">
                    <table>
                        <tr>
                            <td class="list-header">#{param.letter} artists</td>
                        </tr>
                    </table>
                    <h:dataTable value="#{artistListBean.artists}" var="artist" border="0">                             
                        <h:column>
                            <h:commandLink value="#{artist.artistName}" action="#{albumListBean.loadAlbumsByArtistId()}" class="navigation-link-small">
                                <f:param name="artistId" value="#{artist.id}" />
                                <f:param name="artistName" value="#{artist.artistName}" />
                                <f:ajax execute="@this" render="content" />
                            </h:commandLink>
                        </h:column>                                                 
                    </h:dataTable>
                </table>
            </c:if>
        </h:form>

        <h:form id="albumForm">
            <c:if test="#{albumListBean.artistId != null 
                          &amp;&amp; albumListBean.shouldRenderAlbums()}">
                <table>
                    <tr><td height="6">&nbsp;</td></tr>
                </table>
                <table class="navigation-link-small">
                    <table>
                        <tr>
                            <td class="list-header">#{albumListBean.artistName} albums</td>
                        </tr>
                    </table>
                    <h:dataTable value="#{albumListBean.albums}" var="album" border="0">   
                        <h:column>
                            <h:commandLink value="#{album.albumName}" action="#{trackListBean.loadTracksByAlbumId()}" class="navigation-link-small">
                                <f:param name="albumId" value="#{album.id}"/>
                                <f:param name="albumName" value="#{album.albumName}"/>  
                                <f:param name="artistId" value="#{album.artistId}"/>
                                <f:param name="artistName" value="#{albumListBean.artistName}"/>  
                                <f:ajax execute="@this" render="content" />
                            </h:commandLink>
                        </h:column>
                    </h:dataTable>
                    <c:if test="#{albumListBean.looseTracks.size() &gt; 0}">
                        <table>
                            <tr><td height="6">&nbsp;</td></tr>
                        </table>
                        <table>
                            <tr>
                                <td class="list-header">#{albumListBean.artistName} loose tracks</td>
                            </tr>
                        </table>
                        <h:dataTable value="#{albumListBean.looseTracks}" var="track" border="0">   
                            <h:column>
                                <h:commandLink value="#{track.trackName}" action="#{playlistBean.addToPlaylist}" class="navigation-link-small">
                                    <f:param name="trackId" value="#{track.id}"/>
                                    <f:param name="trackName" value="#{track.trackName}" />
                                    <f:ajax execute="@this" render=":playlistForm:playlist" />
                                </h:commandLink>
                            </h:column>
                        </h:dataTable>
                    </c:if>
                </table>
            </c:if>
        </h:form>  

        <h:form id="trackForm">
            <c:if test="#{trackListBean.albumId != null
                          &amp;&amp; trackListBean.shouldRenderTracks()}">
                <table>
                    <tr><td height="6">&nbsp;</td></tr>
                </table>

                <table class="navigation-link-small">
                    <table>
                        <tr>
                            <td class="list-header">#{trackListBean.albumName} tracks</td>
                        </tr>
                    </table>
                    <h:dataTable value="#{trackListBean.tracks}" var="track" border="0">                             
                        <h:column>
                            <h:commandLink value="#{track.trackName}" action="#{playlistBean.addToPlaylist}" class="navigation-link-small">
                                <f:param name="trackId" value="#{track.id}" />
                                <f:param name="trackName" value="#{track.trackName}" />
                                <f:ajax execute="@this" render=":playlistForm:playlist" />
                            </h:commandLink>
                        </h:column>                                                 
                    </h:dataTable>
                </table>
                <table>
                    <tr><td height="6">&nbsp;</td></tr>
                </table>
                <h:commandLink value="Back" action="#{trackListBean.reloadAlbumList()}" class="navigation-link-small">
                    <f:ajax execute="@this" render="content" />
                </h:commandLink>
            </c:if>

            <c:if test="#{trackListBean.albumId == null
                          &amp;&amp; trackListBean.shouldRenderTracks()}">
                <table>
                    <tr><td height="6">&nbsp;</td></tr>
                </table>

                <table class="navigation-link-small">
                    <table>
                        <tr>
                            <td class="list-header">Unsorted tracks</td>
                        </tr>
                    </table>
                    <h:dataTable value="#{trackListBean.tracks}" var="track" border="0">                             
                        <h:column>
                            <h:commandLink value="#{track.trackName}" action="#{playlistBean.addToPlaylist}" class="navigation-link-small">
                                <f:param name="trackId" value="#{track.id}" />
                                <f:param name="trackName" value="#{track.trackName}" />
                                <f:ajax execute="@this" render=":playlistForm:playlist" />
                            </h:commandLink>
                        </h:column>                                                 
                    </h:dataTable>
                </table>          
            </c:if>

        </h:form>

    </h:panelGroup>

</ui:composition>
